# Charpter5 수식과 연산자

C에서 제공되는 수식과 각종 연산자들을 살펴본다.

### 5.1 수식과 연산자의 개념

#### 1. 수식이란

##### 1) 수식

* 피연산자들과 연산자의 조합
  * 가장 간단한 수식은 상수나 변수로만 이루어 진 수식이다.
  * 모든 수식은 값을 갖는다.

##### 2) 피연산자

* 연산의 대상

##### 3) 연산자

* 연산을 나타내는 기호

#### 2. 연산자의 분류

* 피 연산자에 수에 따라 단항, 이항, 삼항연산자로 나뉜다.

|  연산자의 분류   |     연산자      |                    의미                     |
| :--------------: | :-------------: | :-----------------------------------------: |
|       대입       |        =        |            오른쪽을 왼쪽에 대입             |
|       산술       |    + - * / %    |           사칙연산과 나머지 연산            |
|       부호       |       + -       |              양수와 음수 표시               |
|       증감       |      ++ --      |               증가, 감소 연산               |
|       관계       | > < == != >= <= |            오른쪽과 왼쪽을 비교             |
|       논리       |    && \|\| !    |            논리적인 AND, OR, NOT            |
|       조건       |        ?        |              조건에 따라 선택               |
|       콤마       |        ,        |        피연산자들을 순차적으로 실행         |
| 비트 단위 연산자 |  & \|^ ~ << >>  |       비트별 AND, OR, XOR, 이동, 반전       |
|  sizeof 연산자   |     sizeof      | 자료형이나 변수의 크기를 바이트 단위로 반환 |
|      형변환      |     (type)      |         변수나 상수의 자료형을 반환         |
|  포인터 연산자   |     * & []      | 주소 계산, 포인터가 가리키는 곳의 내용 추출 |
|  구조체 연산자   |      . ->       |             구조체의 멤버 참조              |

### 5.2 산술 연산자

#### 1. 산술 연산자

기본적인 덧셈, 뺄셈, 곱셈, 나눗셈, 나머지 연산을 실행하는 연산자

* 자료형이 정수형일 경우 산술 연산값이 소수로 나타나도 소숫점이하는 버려진다.
  * 피연산자가 둘중 하나라도 실수일 경우 값은 실수

#### 2. 나머지 연산자

* 나머지 연산자 %는 홀수나 짝수, 3의 배수 등등 쓰임새가 많은 연산자이다.

* 나머지 연산자는 피연산자가 실수인 경우엔 사용할 수 없다.

#### 3. 부호 연산자

* 부호 연산자는 변수나 상수의 부호르 나타내거나 변경하는 연산자이다.

* 부호 연산자는 단항연산자로 쓰일 수 있고 이항연산자로 쓰일 수도 있다.

#### 4. 증감 연산자

* 증감 연산자는 ++ 기호나 -- 기호를 사용하여 변수의 값을 1만큼 증가시키거나 감소시키는 연산자이다.

  * 변수의 앞과 뒤에 올 수 있는데 이때 의미하는 바가 서로 다르다.

    | 증감 연산자 |               차이점               |
    | :---------: | :--------------------------------: |
    |     ++x     |    수식의 값은 증가된 x값이다.     |
    |     x++     | 수식의 값은 증가되지 않은 x값이다. |
    |     --x     |    수식의 값은 감소된 x값이다.     |
    |     x--     | 수식의 값은 감소되지 않은 x값이다. |

* 증감 연산자는 단항 연산자로 쓰인다.

### 5.3 대입 연산자

변수에 수식의 값을 계산하여 저장하는 연산자

* 등호의 왼쪽은 반드시 변수여야 하고 오른쪽은 어떠한 수식이는 상관없다.
* =를 수학에선 같다고 생각하지만 C에서는 저장한다는 의미로 생각한다.
* y = 10 + (x = 2 + 7 )과 같은 문장도 가능하다. 이 경우엔 안에 있는 대입연산자부터 계산한다.
  * y = x = 3에서도 x = 3이 먼저 수행되고 y에 그 결과 값인 3이 다시 대입된다.

#### 1. 복합 대입 연산자

대입 연산자와 산술 연산자를 합쳐 놓은 것으로 사용하면 소스를 간결하게 만들 수 있다.

| 복합 대입 연산자 |   의 미    |
| :--------------: | :--------: |
|      x += y      | x = x + y  |
|      x -= y      | x = x - y  |
|      x *= y      | x = x * y  |
|      x /= y      | x = x / y  |
|      x %= y      | x = x % y  |
|      x &= y      | x = x & y  |
|     x \|= y      | x = x \| y |
|      x ^= y      | x = x ^ y  |
|     x >>= y      | x = x >> y |
|     x <<= y      | x = x << y |

* 복합 대입 연산자는 우변의 식을 계산하여 그 결과 값은 좌변의 현재값에 지정된 산술연산을 한후 대입한다.
  * x *= y + 1의 경우 x = x * (y+1)이다.

### 5.4 형변환

형변환은 데이터의 형이 변환되는 것을 의미한다. 형변환은 컴파일러에 의한 자동적인 형변환과 프로그래머에 의해 명시적으로 하는 형변환이 있다.

#### 1. 대입 연산지 자동적인 형변환

##### 1) 올림 변환(promotion)

```c
double f;
f = 10;
```

* 위와 같은 경우 10이 double형으로 변환되고 f에 대입되어 10.0이 저장된다. 이를 올림변환이라고 한단.

##### 2) 내림 변환(demotion)

```c
int i;
i = 3.141592;
```

* 위와 같은 경우엔 3.141592가 int형으로 변환되고 i에 대입되어 3이 저장된다. 이를 내림 변환이라고 한다.
  * 내림변환이 일어나면 데이터 손실이 발생할 수 있다.

* 같은 정수 자료형끼리도 내림변환이 발생할 수 있다. 

#### 2. 정수 연산시의 자동적인 형변환

char형이나 short형이 수식에 등장하면 자동적으로 int로 승격시켜 연산한다.

* 정수형 연산을 한가지로 통일하여 시키기 때문.

#### 3. 수식 연산시의 자동적인 형변환

하나의 수식에서 서로 다른 자료형이 사용되면 모든 자료형은 그 중에서 가장 높은 등급의 자료형으로 자동적으로 변환된다.

* 데이터 손실을 막기 위해서이다.

* 자료형을 혼합하여 사용하면 컴파일러는 자료형을 통일 시키려고 노력한다.
  * 정수와 부동소수점 연산은 다른 전자회로를 사용하기 때문이다.

#### 4. 명시적인 형변환

형변환 연산자(type cast)을 이용해 프로그래머가 직접 형변환을 한다.

* 캐스트 연산자라고도 부른다.

| 형식 | (자료형)  수식                               |
| ---- | -------------------------------------------- |
| 설명 | 수식의 값을 지정된 자료형으로 형을 변환한다. |
| 예   | (int) 1.23456                                |
|      | (double) x                                   |
|      | (long) (x + y)                               |

* 형 변환을 하더라도 변수의 형이 변환되는 것이 아니라 변수의 값만 형변환된다.
* 수식 앞에서도 캐스트 연산자를 사용할 수 있다.

### 5.5 관계 연산자

관계 연산자(relational operator)는 두개의 피연산자를 비교하는데 사용된다.

* 결과는 참(1)과 거짓(0)으로 표시 가능하다.

|  연산  |           의미           |
| :----: | :----------------------: |
| x == y |     x와 y가 같은가?      |
| x != y |     x와 y가 다른가?      |
| x > y  |     x가 y보다 큰가?      |
| x < y  |    x가 y보다 작은가?     |
| x >= y | x가 y보다 크거나 같은가? |
| x <= y | x가 y보다 작거나 같은가? |



#### 1. 관계 연산자 사용시 주의점

##### 1) x = y

* 관계연산자 기호는 ==이다. =은 대입 연산자이다.

##### 2) 2 < x < 5

* 수학과 다르게 위 수식은 2 < x 를 먼저 계산하고 값이 참이면 1 < 5로 값이 1이 나오고 거짓이면 0 < 5로 값이 1이 나온다. 
  * 수학과는 다르게 앞부터 계산이 된다. (2 < x) < 5
  * 옳은 방법은 (2 < x) && (x < 5)이다.

##### 3) (1e32 + 0. 01) > 1e32

* 실수의 경우 비트가 한정되어 있기 때문에 오차가 발생할 수 있어 해당 값은 0이다.

##### 4) 그 외

* x =< y 순서가 바뀌었다.
* x < = y 공백이 있으면 안된다.
* x << y 비트 이동 연산자이다.

### 5.6 논리 연산자

여러 개의 조건을 조합하여 참인지 거짓인지를 따질 때 사용하는 연산자.

값은 참일때 1, 거짓일때 0을 가진다.

|   연산   |                         의미                         |
| :------: | :--------------------------------------------------: |
|  x && y  | AND 연산, x와 y가 모두 참이면 참, 그렇지 않으면 거짓 |
| x \|\| y |        OR 연산, x나 y중에서 하나만 참이면 참         |
|    !x    |      NOT연산, x가 참이면 거짓, x가 거짓이면 참       |

#### 1. AND와 OR 연산자

##### 1) AND 연산자 $$

```c
(age <= 30) && (toeic >= 700);
// 둘다 참일경우에만 1출력
```

##### 2) OR 연산자 ||

```c
(x == 1) || (x == 2) || (x == 3);
// x가 1 또는 2 또는 3일경우 1 출력
```

#### 2. NOT 연산자

```c
!(x + y);//수식 (x+y)의 값이 0이면 1, 1이면 0이다.
```

* 1을 제외한 0이 아닌 어떤 값에도 적용하면 0을 만든다.

* 두번 적용해도 원래 값으로 돌아오지 않을 수 있다.

  ```c
  !!3 // 값이 1이 된다.
  ```

#### 3. 참과 거짓

관계 수식이나 논리 수식이 거짓으로 계산되면 0을 생성하고 참으로 계산되면 1을 생성한다. 하지만 **피 연산자의 경우에는 0이 아닌 모든 값은 참으로 간주한다.** 

#### 4. 단축 계산

단축 계산은 모든 계산자들을 계산하지 않고 전체 수식의 값을 얻는 기법이다.

##### 1) &&연산자

```c
(2 > 3) && (++x < 5)
```

* &&연산자의 경우 처음이 거짓이면 두 번째 증가 연산자는 실행되지 않는다.

##### 2) ||연산자

```c
(3 > 2) || (++x < 5)
```

* ||연산자의 경우 처음이 참이면 두번째 증가 연산자는 실행되지 않는다.

### 5.7 조건 연산자

유일하게 3개의 피연산자를 가지는 삼항 연산자이다.

```c
max_value = (x > y) ? x : y;
// x > y가 참이면 x가 수식의 값이 된다.
// x > y가 거짓이면 y를 수식의 값이 된다.
```

* 대표적인 예

  ```c
  absolute_value = (x > 0) ? x: -x; // 절댓값 계산
  max_value = (x > y) ? x : y; // 최댓값 계산
  min_value = (x < y) ? x : y; // 최솟값 계산
  ```

  * 조건연산자는 printf()문도 넣을 수 있다.

### 5.8 콤마 연산자

수식은 콤마로 연결될 수 있으며 각각의 수식은 왼쪽부터 오른쪽으로 순차적으로 실행된다.

```c
x = (2+3, 5-3); // x는 5-3의 값이 된다.
```

* 콤마 연산자의 결과값은 맨 오른쪽 수식의 값이다.
* 콤마 연산자는 연산자들 중 우선순위가 가장 낮다. (마지막에 실행된다.)

* 한정된 공간 안에 여러 개의 문장을 넣을 때 사용된다.

### 5.9 비트 단위 연산자

컴퓨터의 모든 데이터는 결국은 비트로 표현된다. 비트 연산자는 비트 단위로 연산을 수행한다.

| 연산자 |  연산자의 의미  |                           설명                            |
| :----: | :-------------: | :-------------------------------------------------------: |
|   &    |    비트 AND     |  두 개의 피 연산자의 해당 비트가 모두 1이면 1, 아니면 0   |
|   \|   |     비트 OR     | 두 개의 피 연산자의 해당 비트 중 하나만 1이면 1, 아니면 0 |
|   ^    |    비트 XOR     |  두 개의 피연산자의 해당 비트의 값이 같으면 0, 아니면 1   |
|   <<   |  왼쪽으로 이동  |      지정된 개수만큼 모든 비트를 왼쪽으로 이동한다.       |
|  \>>   | 오른쪽으로 이동 |     지정된 개수만큼 모든 비트를 오른쪽으로 이동한다.      |
|   ~    |    비트 NOT     |             0은 1로 만들고 1은 0으로 만든다.              |

* 비트 단위 연산자는 정수 타입의 피 연산자에게만 적용할 수 있다.

#### 1. 비트 AND, OR, XOR, NOT

##### 1) 비트 AND &

* 피 연산자가 모두 1인 경우에만 1을 반환
* 0과 비트값을 AND연산하면 항상 0
* 1과 비트값을 AND연산하면 항상 비트값

##### 2) 비트 OR |

* 피 연산자 둘 중 하나라도 1인경우 1을 반환
* 0과 비트값을 OR연산하면 항상 비트값
* 1과 비트값을 OR연산하면 항상 1

##### 3) 비트 XOR ^

* 피 연산자가 같으면 0 다르면 1을 반환
* 특정 비트값에 XOR연산을 두번하면 원래의 값으로 돌아옴
  * 암호화와 복호화에 사용
* 1과 XOR 연산을 하면 반전된 비트값을 가짐

##### 4) 비트 NOT ~

* 피 연산자가 0이면 1, 1이면 0으로 만드는 연산
* 부호비트도 바꾸기 때문에 부호도 바뀜

#### 2. 비트 이동 연산자 (<<, >>)

비트 이동 연산자는 지정된 숫자만큼 전체 비트를 이동한다.

|      연산자      | 기호 |                     설명                     |
| :--------------: | :--: | :------------------------------------------: |
|  왼쪽 비트 이동  |  <<  |  x << y  x의 비트들을 y칸만큼 왼쪽으로 이동  |
| 오른쪽 비트 이동 | \>>  | x \>> y x의 비트들을 y칸만큼 오른쪽으로 이동 |

* 왼쪽 비트 이동은 값을 2배로, 오른쪽 비트 이동은 값을 1/2배로 만든다.

### 5.10 연산자의 우선 순위와 결합 규칙

#### 1. 연산자의 우선 순위

* 연산자의 우선순위를 사용자가 직접 지정하고 싶으면 괄호를 사용하면 된다,

| 우선순위 | 연산자                                                       | 결합 규칙 |
| -------- | ------------------------------------------------------------ | --------- |
| 1        | () [] -> . ++(후위) --(후위)                                 | →         |
| 2        | sizeof &주소 ++(전위) --(전위) ~ ! *(간접참조) +(부호) -(부호) 형변환 | ←         |
| 3        | *(곱셈) / %                                                  | →         |
| 4        | +(덧셈) -(뺄셈)                                              | →         |
| 5        | << >>                                                        | →         |
| 6        | < <= >= >                                                    | →         |
| 7        | == !=                                                        | →         |
| 8        | &(비트연산)                                                  | →         |
| 9        | ^                                                            | →         |
| 10       | \|                                                           | →         |
| 11       | &&                                                           | →         |
| 12       | \|\|                                                         | →         |
| 13       | ?(삼항)                                                      | ←         |
| 14       | = += *= /= %= &= ^= \|= <<= >>=                              | ←         |
| 15       | ,(콤마)                                                      | →         |

* ```
  콤마 < 대입 < 논리 < 관계 < 산술 < 단항 의 기본 구조를 가짐
  ```

#### 2. 연산자의 결합 규칙

##### 1) 산술 연산자

* 왼쪽에서 오른쪽으로 연산 수행

  * ```
    x * y * z → (x * y) * z
    ```

    * 대부분의 이항 연산자들이 속함

##### 2) 대입 연산자

* 오른쪽에서 왼쪽으로 연산 수행

  * ```
    x = y = z = 5 → x = y = (z = 5)
    ```

    * 형변환 연산자를 포함한 대부분 단항 연산자들이 속함

