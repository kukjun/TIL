# vim 사용법 익히기

###  학습 목표 및 학습 내용

#### 1) 학습 목표

* 유닉스에서 사용하는 편집기의 종류를 알아본다.
* 대표적인 화면 편집기인 vim의 사용 방법을 익힌다.
* vim의 환경 설정방법을 익힌다.

#### 2) 학습 내용

* 유닉스 편집기
* vim의 사용법
* vim의 환경 설정

## 01. 유닉스 편집기

#### 1) 행 단위 편집기 [라인 편집기]

##### a) ed

* 유닉스 초기에 사용

##### b) ex

* 단독으로 사용하기 보다는 vi 와 연결하여 사용

##### c) sed

* 스트림 편집기

#### 2) 화면 편집기

##### a) vim

* vi와 유사한 화면 편집기
  * vi의 상위버전
* 거의 모든 UNIX에서 사용 가능

##### b) emacs

* 막강한 기능 제공

* 설치해서 사용해야 함

##### c) nano - 추가필요

### 1. 모드형과 비모드형 편집기

#### 1) 모드형

* **명령 모드에서 입력한 키는 명령으로 간주**
  * ex) :q, :wq, /문자열 등등, 명령
* 입력모드에서 입력한 키는 데이터로 간주
* 모드를 바꾸기 위한 특수 키가 있음
  * ex) esc

#### 2) 비모드형

* **입력한 모든 키는 데이터로 간주**
* 명령은 특수키(Ctrl, Alt등)와 일반키의 조합으로 구성
* ex) 아래 한글, 워드

## 02. vim 사용법

* 순서
  1. 편집기에서 파일 호출 (디스크 → 버퍼)
  2. 편집기에서 파일 수정 (버퍼)
  3. 파일 저장 (버퍼 → 디스크)
     * 파일 내용을 잘못 수정한 경우 버퍼의 내용을 무시
     * 작업 취소기능 제공

### 1. vim의 동작모드

#### 1) 명령모드

* 입력한 내용을 명령으로 해석
  * <u>vim에서는 대소문자를 별도의 명령으로 해석한다.</u>
  * 커서이동, 페이지 이동, 글자 삭제, 줄 삭제 등

#### 2) 입력모드

* 입력한 내용이 버퍼로 옮겨져 추가, 수정됨
  * 특수키를 입력하기 전까진 데이터를 입력

#### 3) 마지막 행 모드

* 특별명령처리
  * 검색, 저장, 바꾸기, 줄 이동 등

### 2. vim 시작하기

#### 1) vim

```
vim
```

* 새로운 파일 시작
* 파일 저장할 떄 이름 지정

#### 2) vim 파일이름

```
vim first
```

* 지정한 이름이 없으면 새로운 파일 생성
* 지정한 이름이 있으면 기존 파일 열기

### 3. 입력 모드로의 전환, 저장 및 종료

#### 1) 입력 모드

* (명령모드 → 입력모드)

| 명령키 |              기능              |
| :----: | :----------------------------: |
|   i    |         커서 앞에 삽입         |
|   a    |         커서 뒤에 삽입         |
|   o    |      현재 줄 다음에 삽입       |
|   I    | 현재 줄 첫 칸 앞에 텍스트 입력 |
|   A    |    현재 줄 끝에 텍스트 입력    |
|   O    |       현재 줄 앞에 삽입        |

#### 2) 저장 명령

* 저장하려면 종료하거나 "명령모드"로 돌아와야 한다.

|  명령키   |            기능             |
| :-------: | :-------------------------: |
|    :w     | 현재의 파일명으로 파일 저장 |
| :w 파일명 | 지정한 파일명으로 파일 저장 |

#### 3) 종료 명령

* 저장 후 종료, 또는 그냥 종료

|   명령키   |                      기능                       |
| :--------: | :---------------------------------------------: |
|     :q     |        작업 내용을 저장하였으면 vi 종료         |
|    :q!     |        작업 내용을 저장하지 않고 vi 종료        |
|    :wq     |          작업 내용을 저장한 후 vi 종료          |
| :wq 파일명 | 작업 내용을 지정한 파일명으로 저장한 후 vi 종료 |
|     ZZ     |          작업 내용을 저장한 후 vi 종료          |

### 4. 커서 이동

#### 1) 화살표 키 이용 / H, J, K, L 키 이용

|    명령키     |             기능             |
| :-----------: | :--------------------------: |
| k / j / h / l | 한 행 위/ 아래/ 오른쪽/ 왼쪽 |
|     ^ , 0     |          행의 시작           |
|       $       |         행의 마지막          |
|       -       |        이전 행의 처음        |
|   +, Enter    |        다음 행의 처음        |

#### 2) 현재 화면에서 커서 이동

| 명령키 |         기능          |
| :----: | :-------------------: |
|   H    |    키 화면 맨 위로    |
|   M    |    키 화면 중간으     |
|   L    |   키 화면 맨 아래로   |
|   w    | 다음 단어의 첫문자로  |
|   b    | 이전 단어의 첫문자로  |
|   e    | 다음 단어의 끝 글자로 |

#### 3) 지정한 곳으로 이동

| 명령키 |         기능         |
| :----: | :------------------: |
| :n, nG |   줄 번호 n 위치로   |
| :$, G  | 파일의 끝 줄로 이동  |
|   n+   | n줄 만큼 앞으로 이동 |
|   n-   |    n줄 만큼 뒤로     |
|   (    | 현재 문장의 처음으로 |
|   )    | 다음 문장의 처음으로 |
|   {    | 현재 문단의 처음으로 |
|   }    | 다음 문단의 처음으로 |

### 5. 화면이동

* ^ 는 Ctrl +를 의미

| 명령키 |        기능        |
| :----: | :----------------: |
|   ^u   |    반 화면 위로    |
|   ^d   |   반 화면 아래로   |
|   ^b   |    한 화면 위로    |
|   ^f   |   한 화면 아래로   |
|   ^y   |    한 줄만 위로    |
|   ^e   |   한 줄만 아래로   |
|   ^l   | 파일내용 다시 출력 |

### 6. 수정 및 삭제

#### 1) 내용 삭제하기/취소하기

* 명령 모드에서 동작

* '#' 위치에 숫자를 넣으면 해당 숫자만큼 작업 반복

|   명령키   | 삭제대상  |              기능               |
| :--------: | :-------: | :-----------------------------: |
|   x, #x    |   문자    |      커서 위치의 문자 삭제      |
|  dw, #dw   |   단어    |      커서 위치의 단어 삭제      |
|  dd, #dd   |    줄     |       커서 위치의 줄 삭제       |
| D(shift-d) | 줄의 일부 |  커서 위치부터 줄 끝까지 삭제   |
|     u      |           |      방금 수행한 명령 취소      |
|     U      |    줄     |    해당 줄의 모든 편집 취소     |
|    :e!     |   파일    | 마지막 저장 이후 모든 편집 취소 |

#### 2) 내용 수정하기

* 명령 모드에서 동작

| 명령키 | 수정대상 |                         기능                          |
| :----: | :------: | :---------------------------------------------------: |
|   r    |   문자   |             현재 커서위치의 한 문자 변경              |
|   R    |  문자열  |            현재 커서부터 ESC 입력까지 변경            |
|   cw   |   단어   |      커서 위치부터 현재 단어의 끝까지 내용 변경       |
|   cc   |    줄    |             커서가 위치한 줄의 내용 변경              |
| s, #s  |  문자열  | 현재 커서위치의 문자를 ESC 키 입력할 때까지 내용 변경 |
|   C    | 줄 일부  |           커서 위치에서 줄 끝까지 내용 변경           |

### 7. 편집 기능

#### 1) 복사, 잘라내기, 붙이기

* 명령 모드에서 동작

| 명령키  |              기능              |
| :-----: | :----------------------------: |
| yy, #yy | 현재 행을 버퍼로 복사 (예:4yy) |
|    p    | 현재 행 다음에 버퍼 내용 삽입  |
|    P    | 현재 행 위쪽에 버퍼 내용 삽입  |
| dd, %dd |   현재 행 잘라내기(=행삭제)    |

#### 2) 편집하는 범위를 지정하는 방법

* 마지막 행 모드에서 사용

#### 3) 범위 지정하기

* ": 범위 편집명령" 형태로 사용
* 위치 표현 특수 문자
  * . : 현재 줄
  * $ : 마지막 줄

|  범위  |                    의미                    |
| :----: | :----------------------------------------: |
|  1,$   | 첫 줄에서 마지막 줄까지(파일 내의 모든 줄) |
|   %    | 첫 줄에서 마지막 줄까지(파일 내의 모든 줄) |
|  1,.   |           첫 줄에서 현재 줄까지            |
|  .,$   |         현재 줄에서 마지막 줄까지          |
|  .-2   |       현재 줄에서 앞쪽으로 2번째 줄        |
| 10, 20 |        10번째 줄에서 20번째 줄까지         |

#### 4) 복사하기/잘라내기

|  명령키  |                   기능                   |
| :------: | :--------------------------------------: |
|   :#y    |         '#'으로 지정한 행을 복사         |
| :<범위>y |         범위로 지정한 행을 복사          |
|   :#d    |         '#'으로 지정한 행을 삭제         |
| :<범위>d |         범위로 지정한 행을 삭제          |
|   :pu    |      형재 행 다음에 버퍼내용 붙이기      |
|   :#pu   | '#'으로 지정한 행 다음에 버퍼내용 붙이기 |

#### 5) 검색하기

| 명령키  |                  기능                   |
| :-----: | :-------------------------------------: |
| /문자열 | 현재 위치부터 파일 앞쪽으로 문자열 탐색 |
| ?문자열 | 현재 위치부터 파일 뒤쪽으로 문자열 탐색 |
|    n    |            다음 문자열 탐색             |
|    N    |         역방향으로 문자열 탐색          |

#### 6) 바꾸기

|           명령키            |                             기능                             |
| :-------------------------: | :----------------------------------------------------------: |
|     :s/문자열1/문자열2/     |       커서가 위치한 줄에서만 문자열1을 문자열2로 바꿈        |
|  :<범위>s/문자열1/문자열2/  | <범위>안의 모든 줄에 대해서 각 줄의 첫번째 문자열1을 찾아 문자열2로 바꿈 |
| :<범위>s/문자열1/문자열2/g  | <범위>안의 모든 줄에 대해서 모든 문자열1을 찾아 문자열2로 바꿈 |
| :<범위>s/문자열1/문자열2/gc | <범위>안의 모든 줄에 대해서 각 문자열1을 문자열2로 치환할 때 수정할지 안 할지를 묻는다. |

### 8. 비주얼 모드

#### 1) 비주얼 모드로의 전환

* 편집할 블록을 선택 → 비주얼 모드
* v, V, Ctrl+v 명령어 입력 → 서로 다른 비주얼 모드

| 구분        | 명령키 | 기능                                          |
| ----------- | ------ | --------------------------------------------- |
| 비주얼      | v      | 현재 커서 위치부터 블록 지정                  |
| 비주얼 라인 | V      | 현재 커서가 위치한 행 단위로 블록 지정        |
| 비주얼 블록 | Ctrl+V | 현재 커서가 위치한 열부터 열 단위로 블록 지정 |

| 명령키 | 기능      |
| ------ | --------- |
| y      | 블록 복사 |
| d      | 블록 삭제 |

### 9. 기타 유용한 명령

#### 1) 파일 읽어오기 / 여러 파일 편집

| 명령키    | 수 행                                                   |
| --------- | ------------------------------------------------------- |
| :r 파일명 | 지정한 파일을 현재 커서 위치에 삽입                     |
| :e 파일명 | 현재 파일 대신 지정한 파일을 읽음                       |
| :n        | vim 시작시 여러 파일을 지정하였을 경우 다음 파일로 이동 |

#### 2) vim 에서 쉘 명령 실행

| 명령키 | 기능                                                    |
| ------ | ------------------------------------------------------- |
| :!명령 | vim을 중단하고 지정한 명령 수행 (vim로 돌아올때 : 엔터) |
| :sh    | vim을 잠시 빠져나가서 쉘을 수행 (vim로 돌아올때 : exit) |

#### 3) 알아두면 유용한 명령키들

| 명령키    | 수 행                                                |
| --------- | ---------------------------------------------------- |
| :f 파일명 | 파일 이름을 지정한 이름으로 변경                     |
| :w %.old  | 현재 파일을 .old 파일로 저장해 둘 때                 |
| ^g        | 기본적인 파일정보 출력 (파일명, 라인 수 등)          |
| J         | 현재 줄과 다음 줄 연결                               |
| .         | 바로 이전에 수행한 명령 재 실행                      |
| ~         | 현재 커서 위치의 한 문자를 소문자 혹은 대문자로 전환 |

## 03. vim 환경 설정

**vim의 환경을 설정하는 특수 명령과 변수들**

| 명령키          | 기능                                             |
| --------------- | ------------------------------------------------ |
| :set nu         | 파일 내용의 각 줄에 줄 번호 표시                 |
| :set nonu       | 줄 번호 취소                                     |
| :set list       | 눈에 보이지 않는 특수문자 표시(tab:^l, eol:$ 등) |
| :set nolist     | 특수문자보기 취소                                |
| :set showmode   | 현재 모드 표시                                   |
| :set noshowmode | 현재 모드 표시기능 취소                          |
| :set            | set으로 설정한 모든 vi변수 출력                  |
| :set all        | 모든 vim 변수와 현재 값 출력                     |

