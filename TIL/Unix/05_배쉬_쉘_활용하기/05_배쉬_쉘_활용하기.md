# 배시 쉘 활용하기

### 학습 목표 및 학습 내용

#### 1) 학습 목표

* 배시 쉘이 제공하는 다양한 기능을 이해하고 활용한다.
* 환경변수를 이용해 작업의 효율을 높이는 환경을 설정하는 방법을 익힌다.
* 황경 설정 파일을 이용해 자신만의 환경을 설정하는 방법을 익힌다.

#### 2) 학습 내용

* 쉘 기본 사용법 익히기
* 입출력 방향 변경
* 배시 쉘의 환경 설정
* 명령 다루기
* 프롬프트 설정하기
* 활경 설정파일 설정하기

## 01. 쉘이란?

* 명령어 해석기

#### 1) 쉘

* 사용자와 커널 사이의 중간 역할
* 사용자가 입력한 명령을 처리 하고 실행 결과를 알려준다.
* 편리한 사용을 위해 다양한 기능 제공

#### 2) 쉘의 종류

* 본 쉘(sh), C 쉘(csh), 콘 쉘(ksh), 배시 쉘(bash), ...

* 종류 확인하기

  * 프롬프트로 확인 : C쉘은 %, 본, 콘, 배시 쉘은 $

    * \#인 경우, 시스템관리자 계정

  * 명령으로 확인

    * ```
      $ echo $SHELL
      ```

## 02. 쉘 기본 사용법 익히기

### 1. 문자열 출력

##### a) echo

* 쉘 명령과 유틸리티 모두 제공
* 지정한 문자열 출력

##### b) printf

* 쉘 명령
* 옵션이 제공되어 echo 보다 편리

### 2. 쉘 특수문자

#### 1) 쉘이 특별하게 처리하는 문자들

* 잘 활용하면 명령을 입력할 때 매우 편리하다.

|   메타문자    |                         기능                          |
| :-----------: | :---------------------------------------------------: |
|       *       |                     임의의 문자열                     |
|       ?       |                    임의의 한 문자                     |
|      [ ]      |            대괄호안에 포함된 문자 중 하나             |
|       ~       |                      홈 디렉토리                      |
|       -       |                  이전 작업 디렉토리                   |
|       ;       |            명령 연결, 왼쪽부터 차례로 실행            |
|      &&       | 명령 연결, 왼쪽부터 차례로 실행, 성공시 다음명령 실행 |
|      \|       |   왼쪽 명령의 실행 결과를 오른쪽 명령의 입력을 전달   |
|      ' '      |                 모든 쉘 특수문자 무시                 |
|      " "      |          $, `,\\를 제외한 모든 쉘 문자 무시           |
|     \` \`     |                     쉘 명령 수행                      |
|      \\       |                  특수문자 기능 제거                   |
| \>, >>, <, << |                   입출력 방향 변경                    |

## 03. 입출력 방향 변경

#### 1) 표준 입출력 장치

|           | 파일 디스크립터 | 파일 이름 | 설명                                               | 기본장치 |
| --------- | --------------- | --------- | -------------------------------------------------- | -------- |
| 표준입력  | 0               | stdin     | 명령의 실행에 피료한 데이터를 읽어들이는 기본 장치 | 키보드   |
| 표준 출력 | 1               | stdout    | 명령 실행 결과를 출력하는 장치                     | 모니터   |
| 표준 오류 | 2               | stderr    | 명령 실행 중 발생한 오류 메시지를 출력하는 장치    | 모니터   |

### 1. 리다이렉션

#### 1) 리다이렉션

* 입출력 장치의 변경
  * 특수 기호를 사용하여 표준 입출력 장치를 변경

#### 2) 출력 리다이렉션

```
$ 명령 > 파일명
$ 명령 >> 파일명
```

##### a) >, >>

* 표준 출력을 모니터에서 파일로 변경
  * $ 명령 > 파일명
    * \> : 새로운 파일을 생성, 기존의 파일은 없어짐
  * $ 명령 >> 파일명
    * \>> : 기존 파일의 끝에 내용을 추가

#### 3) 오류 리다이렉션

```
$ 명령 2> 파일명
```

* **표준 오류 메시지를 파일에 저장**
  * 오류와 정상출력 중 어느것이  먼저 실행될지 알수 없으나 보통 오류먼저 실행

####  4) 입력 리다이렉션

```
$ 명령 < 파일명
```

* 표준 입력을 키보드에서 파일로 변경

## 04. 배시 쉘 환경 설정

### 1. 변수

#### 1) 변수

* 시스템이나 사용자에 의해 사용되는 정보를 저장하기 위한 저장소
* 쉘 변수는 관례적으로 대문자를 사용

#### 2) 쉘 변수

* 현재의 쉘에서만 사용 가능한 변수
* 확인 명령 : set

#### 3) 환경 변수

* 모든 쉘에서 사용 가능한 변수
* 확인 명령 : env

### 2. 변수 정의

#### 1) 변수 정의

* 쉘 변수 : 변수 = 값
* 환경변수
  * 변수 = 값; export 변수명
  * export 변수 = 값

#### 2) 변수 값 확인

* set, env 명령으로 확인
* echo $변수명

#### 3) 변수 정의 해제

* unset 변수명

### 3. 컨트롤 키

| 컨트롤 키 | stty명 | 의미                                         |
| --------- | ------ | -------------------------------------------- |
| Ctrl + C  | intr   | 현재 명령 중지                               |
| Ctrl + D  | eof    | 파일의 끝(혹은 입력의 끝)                    |
| Ctrl + \  | quit   | Ctrl + C가 동작하지 않을 경우 현재 명령 중지 |
| Ctrl + S  | stop   | 화면 출력 정지                               |
| Ctrl + Q  | start  | 화면 출력 다시 시작                          |
| Ctrl + ?  | erase  | 마지막 문자 삭제                             |
| Ctrl + U  | kill   | 전체 명령 행 삭제                            |
| Ctrl + W  | werase | 마지막 단어 삭제                             |
| Ctrl + Z  | susp   | 현재 명령 일시 중단                          |

## 05. 배쉬 쉘 명령 다루기

* 쉘에서 명령을 편리하게 입력하기 실행하기 위한 여러 가지 기능들
* 앨리어스 [alias]
  * 나만의 명령 만들기
* 히스토리 [history]
  * 이전에 입력한 명령 사용하기
* 명령어 편집하기

### 1. 엘리어스

```
alias 별칭='명령'
	unalias 별칭
```
* **명령어에 다른 이름을 정의하여 사용.**
  * 긴 명령어 대신 짧은 별칭을 사용
  * 자주 사용하는 옵션 자동 수행
  * 여러 명령을 하나의 명령으로 대체 가능
    * 단 명령에 인자가 필요한 경우, 인자를 넘겨주지는 못함

* **명령**

  * 현재 설정값 보기 : alias

  * 앨리어스 설정 : alias 별칭=명령

  * 앨리어스 해제 : unalias 별칭

  * 앨리어스 무시 : 명령어 앞에 \

    * 만약 ls -al을 ls로 엘리어스 했을때, ls -a를 불러오는 방법

      ```
      \ls -a
      ```

### 2. 히스토리

```
history [ 옵션 ]
```

* **사용자가 입력한 명령을 기록, 재사용 할 수 있도록 함**

  * 히스토리 목록에서 명령어를 선택하거나 편집
  * ~/.bash_history 파일에 명령 저장

* 명령 재실행

  ```
  ! 문자
  ! 번호
  ```

  * 이전에 실행했던 명령을 반복 실행하는 기능
  * 이번트 지정자 (!)을 이용하여 명령 실행

| 명령             | 설명                                                       |
| ---------------- | ---------------------------------------------------------- |
| !!               | 마지막 명령 실행                                           |
| !n               | n번째 명령 실행                                            |
| !-n              | 현재 명령에서 뒤로 n번째 명령                              |
| !문자열          | 주어진 문자열로 시작하는 명령 중 마지막 명령               |
| <이벤트명령>:p   | !!,!n등 이벤트 지정자로 시작한 명령을 화면에 출력          |
| !?문자열?        | 주어진 문자열을 포함하는 명령 중 마지막 명령. ?는 선택항목 |
| ^문자열1^문자열2 | 마지막 명령의 문자열1을 문자열2로 대체하여 다시 실행       |

* 명령 편집하기
  * 이전 명령을 편집하여 다시 실행
  * 화살표 키를 이용하거나 편집기를 이용
  * 화살표 키의 이용 방법
    1. ↑또는 ↓화살표키를 이용하여 이전 명령을 불러옴
    2. ←또는 →화살표키를 이용하여 수정할 위치로 커서 이동
    3. [Del] 또는 [←]키를 이용하여 수정할 내용 삭제 후 새로운 내용 입력

## 06. 프롬프트 설정하기

#### 1) 프롬프트

* 명령 입력을 기다리는 시스템 상태 표시

#### 2) 기본 프롬프트 모양

* 배시 쉘, 본쉘, 콘쉘 : $
* C 쉘 : %

#### 3) 프롬프트 설정

* 환경 변수 PS1에 저장된 값을 프롬포트로 사용

* PS1 값 확인

  ```
  $ echo $PS1
  $ (PS1의 값)
  $ (프롬프트)
  ```

* 이스케이프 시퀸스 [Escape Sequence]

  * 단말기의 제어를 위해 정의된 문자열

    | 이스케이프 문자 | 기능                                   |
    | --------------- | -------------------------------------- |
    | \n              | 현재 사용자 이름 ($LOGNAME 과 동일)    |
    | \h              | 호스트 이름 (\`uname -n\` 명령과 동일) |
    | \w              | 현재 작업 디렉토리 ($PWD와 유사)       |
    | \t              | 24시간 형식으로 나타낸 시각(HH:MM:SS)  |
    | \A              | 24시간 형식으로 나타낸 시각(HH:MM)     |
    | \\!             | 히스토리 번호                          |

## 07. 환경 설정 파일

#### 1) 초기화 파일

* 쉘이 시작할 때 실행되는 명령어와 변수 설정 저장
* 로그인할 때 실행
* 종류 : 시스템 초기화 파일, 사용자 초기화 파일

#### 2) 시스템 초기화 파일

* 시스템을 사용하는 전체 사용자들의 공통 환경설정
* /etc 디렉토리에 위치
* 시스템 관리자가 관리

#### 3) 사용자 초기화 파일

* 사용자 홈 디렉토리에 위치
* 사용자별 환경 설정 : 프롬프트, 경로, 앨리어스 등

#### 4) 쉘에 따른 시스템 초기화 파일

##### a) 배시 쉘

* 시스템 초기화 파일

  ```
  /etc/profile
  ```

| 사용자 초기화 파일  | 실행조건               | 실행시기 |
| ------------------- | ---------------------- | -------- |
| $HOME/.bash_profile |                        | 로그인   |
| $HOME/.bash_login   |                        | 로그인   |
| $HOME/.profile      | .bash_profile이 없으면 | 로그인   |
| $HOME/.bashrc       |                        | 서브쉘   |
| $HOME/.bash_logout  |                        | 로그아웃 |

#### 5) 사용자 초기화 파일 실행하기

```
$ source ~/.profile
	$.  ~/.profile
```

* 수정된 환경 설정 파일 내용의 적용
  * logout했다가 다시 login하거나 logout하지 않고 적용하려면 위의 명령을 수행한다.